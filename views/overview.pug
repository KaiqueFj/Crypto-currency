extends base

block append head
  script(defer src="/js/bundled/index.js")



block content

  .container(class="flex flex-col w-full")

    main.main(class="flex flex-col mx-auto ")

      h1(class="text-2xl font-bold mb-4")= `Top ${itemsPerPage} coins in the market`

      .coin-container(class="flex flex-col  p-4")
        h2.text-xl.font-semibold.mt-8.mb-4 CryptoCurrency list
        table.min-w-full.divide-y.divide-gray-200
          thead.bg-gray-50
            tr
              th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Coin
              th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Price (USD)
              th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider 1h
              th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider 24h
              th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider 7d
              th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider 24h volume
              th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Market cap
              th.px-6.py-3.text-left.text-xs.font-medium.text-gray-500.uppercase.tracking-wider Last 7 days
          tbody.bg-white.divide-y.divide-gray-200
            each coin in coins
              tr(data-href=`/coin/${coin.id}/usd`, class="cursor-pointer hover:bg-gray-100 transition")
                td.px-6.py-4.whitespace-nowrap
                  .flex.items-center
                    img.coin-image.w-10.h-10.object-cover.rounded-full(src=coin.image alt=coin.name)
                    .flex.ml-4
                      p(class="tw-text-gray-700 dark:tw-text-moon-100 font-bold tw-text-sm px-1 tw-leading-5")= coin.name
                      p(class="tw-text-gray-800 dark:tw-text-moon-100 font-normal tw-text-sm tw-leading-5")= `${coin.symbol.toUpperCase()}`

                td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500= `$${coin.current_price.toLocaleString()}`
                td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500= `${coin.price_change_percentage_1h_in_currency.toFixed(2)}%`
                td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500= `${coin.price_change_percentage_24h_in_currency.toFixed(2)}%`
                td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500= `${coin.price_change_percentage_7d_in_currency.toFixed(2)}%`
                td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500= `$${coin.circulating_supply.toLocaleString()}`
                td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500= `$${coin.market_cap.toLocaleString()}`
                td.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500
                  canvas(id=`chart-${coin.id}`).w-24.h-24



        .infoPagination(class=" flex flex-row justify-between items-center")

          span.px-6.py-4.whitespace-nowrap.text-sm.text-gray-500= `Showing ${(currentPage - 1) * itemsPerPage + 1} to ${Math.min(currentPage * itemsPerPage, allCoin.length)} of ${allCoin.length} coins`

          nav(class="  inline-flex items-center space-x-1 rounded-lg")
            ul.pagination(class= "flex flex-row gap-1")
              li
                a( class="px-4 py-2 text-zinc-950 rounded-lg hover:bg-gray-100" href=`/overview?page=1&per_page=${itemsPerPage}`)= `1`

              if currentPage > 1
                li
                  a( class="px-4 py-2 text-zinc-950 rounded-lg hover:bg-gray-100" href=`/overview?page=${currentPage}&per_page=${itemsPerPage}`)= `${currentPage}`


              if currentPage < totalPages
                li
                  a(class="px-4 py-2 text-zinc-950 rounded-lg hover:bg-gray-100" href=`/overview?page=${currentPage + 1}&per_page=${itemsPerPage}`)= `${currentPage + 1}`
                  a(class="px-4 py-2 text-zinc-950 rounded-lg hover:bg-gray-100" href=`/overview?page=${currentPage + 2}&per_page=${itemsPerPage}`)= `${currentPage + 2}`


              li= `...`
              li
                a(class="px-4 py-2 text-zinc-950 rounded-lg" href=`/overview?page=${totalPages}&per_page=${itemsPerPage}`)= `${totalPages}`



          .dropdown(class="flex relative items-center")
            button.dropdownButton(class="block px-1 ") Show rows
            .coinsToShow(class="show px-1 py-1 m-1 rounded-lg bg-gray-100 cursor-pointer")
              span.rowValue=totalRows
              i.fa-solid.fa-chevron-down(class="ml-2") 
            .dropdownOptions(class= "dropdownOptions hidden px-2 py-2 top-full flex-col absolute  left-20 shadow-xl drop-shadow-xl rounded-lg bg-gray-200 ")
              button.option(class=" px-4 py-2 hover:bg-gray-100 rounded-lg") 5 
              button.option(class=" px-4 py-2 hover:bg-gray-100 rounded-lg") 10
              button.option(class=" px-4 py-2 hover:bg-gray-100 rounded-lg") 20
